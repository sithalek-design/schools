<script>
  const STORAGE_KEY = "selected_teachers";

  /* Get saved IDs */
  function getSavedIds() {
    return JSON.parse(localStorage.getItem(STORAGE_KEY)) || [];
  }

  /* Save IDs */
  function saveIds(ids) {
    localStorage.setItem(STORAGE_KEY, JSON.stringify(ids));
  }

  /* When checkbox is clicked */
  document.addEventListener("change", function (e) {
    if (!e.target.classList.contains("row-checkbox")) return;

    let ids = getSavedIds();
    const id = e.target.value;

    if (e.target.checked) {
      if (!ids.includes(id)) ids.push(id);
    } else {
      ids = ids.filter((x) => x !== id);
    }

    saveIds(ids);
  });

  /* Restore checked state when page loads */
  document.addEventListener("DOMContentLoaded", function () {
    const ids = getSavedIds();
    document.querySelectorAll(".row-checkbox").forEach((cb) => {
      cb.checked = ids.includes(cb.value);
    });
  });
</script>